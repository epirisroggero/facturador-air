<?xml version="1.0" encoding="utf-8"?>
<s:Panel xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:mx="library://ns.adobe.com/flex/mx" xmlns:s="library://ns.adobe.com/flex/spark"
		 width="100%" height="100%" backgroundAlpha="0.0" title="Resumen" styleName="pnlInterno" creationComplete="panel1_creationCompleteHandler(event)">
	
	<fx:Script>
		<![CDATA[
			import biz.fulltime.conf.GeneralOptions;
			import biz.fulltime.model.Documento;
			import biz.fulltime.model.ParticipacionVendedor;
			import biz.fulltime.model.Usuario;
			
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			
			import util.CatalogoFactory;
			
			private var _gasto:Documento;
			
			[Bindable]
			private var _simbolo:String;
			
			[Bindable]
			private var hasPerm:Boolean;
			
			private var changeFactura:Boolean;
			
			private var _modoSolicitud:Boolean = false;
			
			[Bindable]
			public function get modoSolicitud():Boolean {
				return _modoSolicitud;
			}
			
			public function set modoSolicitud(value:Boolean):void {
				_modoSolicitud = value;
			}
			
			override protected function commitProperties():void {
				super.commitProperties();
				
				if (changeFactura) { 
					changeFactura  = false;
					
					// Verificar permisos
					hasPerm = !GeneralOptions.getInstance().modoMostrador && !GeneralOptions.getInstance().loggedUser.usuarioModoDistribuidor
						&& (gasto.permisosDocumentoUsuario.rentaReal || gasto.permisosDocumentoUsuario.rentaDistribuidor);
				}
			}
			
			[Bindable]
			public function get gasto():Documento {
				return _gasto;
			}
			
			public function set gasto(value:Documento):void {
				_gasto = value;
				
				changeFactura  = true;
				invalidateProperties();
			}
						
			protected function panel1_creationCompleteHandler(event:FlexEvent):void {
				GeneralOptions.getInstance().addEventListener("_changeModoMostrador", function(evt:Event):void {
					// Verificar permisos
					hasPerm = !GeneralOptions.getInstance().modoMostrador && !GeneralOptions.getInstance().loggedUser.usuarioModoDistribuidor
					&& (gasto.permisosDocumentoUsuario.rentaReal || gasto.permisosDocumentoUsuario.rentaDistribuidor);
				});
				
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<s:NumberFormatter id="nf_Espanol_Espanol" locale="es_ES" fractionalDigits="2"/>
	</fx:Declarations>
	
	<s:layout>
		<s:VerticalLayout  horizontalAlign="left" paddingLeft="10" paddingRight="10" verticalAlign="top" />
	</s:layout>
	<s:Form width="100%">
		<s:layout>
			<s:FormLayout gap="0"/>
		</s:layout>
		<s:FormItem width="100%" label="SUBTOTAL:">
			<s:Label width="100%" textAlign="right" text="{gasto.moneda.simbolo + ' ' + nf_Espanol_Espanol.format(gasto.subTotal)}" />
		</s:FormItem>
		<s:FormItem width="100%" label="IVA:">
			<s:Label width="100%" textAlign="right" text="{gasto.moneda.simbolo + ' ' + nf_Espanol_Espanol.format(gasto.iva)}" />
		</s:FormItem>
		<s:FormItem>
			<s:Line width="100%" height="1">
				<s:stroke>
					<s:SolidColorStroke id="lineStroke3" color="#6565FF" alpha="0.28" />
				</s:stroke>
			</s:Line>
		</s:FormItem>
		
		<s:FormItem width="100%" label="TOTAL:" fontSize="18" verticalCenter="0">
			<s:Label width="100%" textAlign="right" fontSize="20" text="{gasto.moneda.simbolo + ' ' + nf_Espanol_Espanol.format(gasto.total)}" />
		</s:FormItem>
	</s:Form>
	
</s:Panel>
