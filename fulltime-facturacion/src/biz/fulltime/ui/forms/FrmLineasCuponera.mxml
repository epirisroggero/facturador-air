<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:components="components.*" xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:lineas="biz.fulltime.ui.lineas.*" xmlns:mx="library://ns.adobe.com/flex/mx"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 width="100%" height="100%" creationComplete="creationCompleteHandler(event)">
	<fx:Script>
		<![CDATA[
			import biz.fulltime.model.Auditoria;

			import mx.collections.ArrayCollection;
			import mx.events.CloseEvent;
			import mx.events.FlexEvent;
			import mx.formatters.DateFormatter;

			import spark.events.GridSelectionEvent;
			import spark.events.IndexChangeEvent;

			private var _lineas:ArrayCollection;

			[Bindable]
			private var lastIndex:int = -1;

			[Bindable]
			public function get lineas():ArrayCollection {
				return _lineas;
			}

			public function set lineas(value:ArrayCollection):void {
				_lineas = value;
			}

			protected function creationCompleteHandler(event:FlexEvent):void {
				if (lstauditoria.dataProvider.length > 0) {
					callLater(function():void {
							lstauditoria.selectedIndex = 0;
						});
				}
			}

			protected function cmdCancelar_clickHandler(event:MouseEvent):void {
				callLater(function():void {
						if (lstauditoria.dataProvider.length > 0) {
							lstauditoria.selectedIndex = lastIndex;
						}
					});
			}

			private function fixLabel(item:Object, column:GridColumn):String {
				var dateFormatter:DateFormatter = new DateFormatter();
				dateFormatter.formatString = "DD-MM-YYYY";

				return dateFormatter.format(item.fecha);
			}

			private function fixComprobante(item:Object, column:GridColumn):String {
				return item.serie + item.numero;
			}



			protected function cmdClose_clickHandler(event:MouseEvent):void {
				dispatchEvent(new CloseEvent(CloseEvent.CLOSE));
			}

			protected function cmdCerrar_clickHandler(event:MouseEvent):void {
				dispatchEvent(new CloseEvent(CloseEvent.CLOSE));
			}
		]]>
	</fx:Script>

	<s:Panel width="100%" height="100%" backgroundAlpha=".5" borderColor="#B5A7A7" borderVisible="true" dropShadowVisible="false" title="Movimientos">
		<s:BorderContainer width="100%" height="100%" backgroundAlpha=".16" backgroundColor="#6E87B5" borderAlpha="0">
			<s:layout>
				<s:VerticalLayout />
			</s:layout>

			<s:DataGrid id="lstauditoria" width="100%" height="100%" dataProvider="{lineas}">
				<s:columns>
					<s:ArrayList>
						<s:GridColumn headerText="COMPROBANTE" dataField="numero" labelFunction="fixComprobante" />
						<s:GridColumn headerText="FECHA" dataField="fecha" labelFunction="fixLabel" />
						<s:GridColumn headerText="CANTIDAD" dataField="cantidad" />
						<s:GridColumn headerText="SALDO" dataField="saldo" />
					</s:ArrayList>
				</s:columns>
			</s:DataGrid>
		</s:BorderContainer>
		<s:controlBarContent>
			<s:HGroup width="100%" horizontalAlign="right" paddingBottom="5" paddingRight="5" paddingTop="5" verticalAlign="middle">
				<mx:Image id="loader1" source="@Embed(source='assets/general/logo_oscuro.gif')" alpha=".5" scaleX=".20" scaleY=".20" />
				<s:Spacer width="100%" />
				<s:Button id="cmdClose" click="cmdClose_clickHandler(event)" label="Cerrar" styleName="closeButton16" />
			</s:HGroup>
		</s:controlBarContent>

	</s:Panel>

</s:Group>
